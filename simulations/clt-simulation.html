<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Central Limit Theorem - Interactive Simulation</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        header h1 {
            font-size: 2.5em;
            font-weight: 300;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .back-link {
            text-align: center;
            margin: 20px 0;
        }
        
        .back-link a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        .back-link a:hover {
            text-decoration: underline;
        }
        
        .simulation-container {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            margin: 20px 0;
        }
        
        .description {
            margin-bottom: 30px;
            padding: 20px;
            background: #f7fafc;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .control-group {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
        }
        
        .control-group label {
            display: block;
            color: #4a5568;
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .control-group input[type="range"] {
            width: 100%;
            margin-bottom: 5px;
        }
        
        .control-group .value {
            color: #667eea;
            font-weight: 600;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5a67d8;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        
        .btn-secondary {
            background: #e2e8f0;
            color: #2d3748;
        }
        
        .btn-secondary:hover {
            background: #cbd5e0;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            margin: 30px 0;
        }
        
        .results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .result-card {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .result-card h3 {
            color: #4a5568;
            font-size: 0.9em;
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .result-card .value {
            color: #667eea;
            font-size: 2em;
            font-weight: 600;
        }
        
        .theory-section {
            margin-top: 40px;
            padding: 30px;
            background: #edf2f7;
            border-radius: 10px;
        }
        
        .theory-section h2 {
            color: #2d3748;
            margin-bottom: 15px;
        }
        
        .theory-section p {
            color: #4a5568;
            line-height: 1.8;
        }
        
        footer {
            text-align: center;
            padding: 40px 0;
            color: #718096;
        }
    </style>
</head>
<body>
    <header>
        <h1>Central Limit Theorem</h1>
        <p>Observe the emergence of the normal distribution</p>
    </header>
    
    <div class="container">
        <div class="back-link">
            <a href="../Simulations.html">‚Üê Back to Simulations</a>
        </div>
        
        <div class="simulation-container">
            <div class="description">
                <p>The Central Limit Theorem states that the distribution of sample means approximates a normal distribution as the sample size gets larger, regardless of the population's distribution. Watch this fundamental principle of statistics come to life!</p>
            </div>
            
            <div class="controls">
                <div class="control-group">
                    <label>Sample Size: <span class="value" id="sample-size-value">30</span></label>
                    <input type="range" id="sample-size" min="5" max="100" value="30" step="5">
                </div>
                <div class="control-group">
                    <label>Number of Samples: <span class="value" id="num-samples-value">1000</span></label>
                    <input type="range" id="num-samples" min="100" max="10000" value="1000" step="100">
                </div>
                <div class="control-group">
                    <label>Distribution Type:</label>
                    <select id="distribution-type" style="width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #cbd5e0;">
                        <option value="uniform">Uniform</option>
                        <option value="exponential">Exponential</option>
                        <option value="binomial">Binomial</option>
                    </select>
                </div>
            </div>
            
            <div class="buttons">
                <button class="btn btn-primary" onclick="runSimulation()">Run Simulation</button>
                <button class="btn btn-secondary" onclick="resetSimulation()">Reset</button>
            </div>
            
            <div class="chart-container">
                <canvas id="cltChart"></canvas>
            </div>
            
            <div class="results">
                <div class="result-card">
                    <h3>Sample Mean</h3>
                    <div class="value" id="sample-mean">-</div>
                </div>
                <div class="result-card">
                    <h3>Standard Error</h3>
                    <div class="value" id="standard-error">-</div>
                </div>
                <div class="result-card">
                    <h3>Skewness</h3>
                    <div class="value" id="skewness">-</div>
                </div>
            </div>
            
            <div class="theory-section">
                <h2>Understanding the Central Limit Theorem</h2>
                <p>The CLT is one of the most important theorems in statistics. It tells us that when we take many samples from any distribution (with finite variance) and calculate their means, those means will be normally distributed. This holds true even if the original population is not normally distributed!</p>
                <p>Key insights:</p>
                <ul style="margin-left: 20px; color: #4a5568;">
                    <li>As sample size increases, the distribution becomes more normal</li>
                    <li>The mean of sample means equals the population mean</li>
                    <li>The standard error decreases as sample size increases</li>
                </ul>
            </div>
        </div>
    </div>
    
    <footer>
        <p>&copy; 2025 He Wang. Educational Simulations.</p>
    </footer>
    
    <script>
        let chart;
        
        // Update value displays
        document.getElementById('sample-size').addEventListener('input', function() {
            document.getElementById('sample-size-value').textContent = this.value;
        });
        
        document.getElementById('num-samples').addEventListener('input', function() {
            document.getElementById('num-samples-value').textContent = this.value;
        });
        
        // Initialize chart
        const ctx = document.getElementById('cltChart').getContext('2d');
        chart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: [],
                datasets: [{
                    label: 'Frequency',
                    data: [],
                    backgroundColor: 'rgba(102, 126, 234, 0.6)',
                    borderColor: 'rgba(102, 126, 234, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Frequency'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Sample Mean'
                        }
                    }
                },
                plugins: {
                    title: {
                        display: true,
                        text: 'Distribution of Sample Means'
                    }
                }
            }
        });
        
        function generateSample(size, distribution) {
            let sample = [];
            for (let i = 0; i < size; i++) {
                if (distribution === 'uniform') {
                    sample.push(Math.random());
                } else if (distribution === 'exponential') {
                    sample.push(-Math.log(1 - Math.random()));
                } else if (distribution === 'binomial') {
                    sample.push(Math.random() > 0.5 ? 1 : 0);
                }
            }
            return sample;
        }
        
        function calculateMean(arr) {
            return arr.reduce((a, b) => a + b, 0) / arr.length;
        }
        
        function runSimulation() {
            const sampleSize = parseInt(document.getElementById('sample-size').value);
            const numSamples = parseInt(document.getElementById('num-samples').value);
            const distribution = document.getElementById('distribution-type').value;
            
            let sampleMeans = [];
            
            // Generate samples and calculate means
            for (let i = 0; i < numSamples; i++) {
                const sample = generateSample(sampleSize, distribution);
                sampleMeans.push(calculateMean(sample));
            }
            
            // Create histogram data
            const bins = 30;
            const min = Math.min(...sampleMeans);
            const max = Math.max(...sampleMeans);
            const binWidth = (max - min) / bins;
            
            let histogram = new Array(bins).fill(0);
            let binLabels = [];
            
            for (let i = 0; i < bins; i++) {
                binLabels.push((min + i * binWidth).toFixed(3));
            }
            
            sampleMeans.forEach(mean => {
                const binIndex = Math.min(Math.floor((mean - min) / binWidth), bins - 1);
                histogram[binIndex]++;
            });
            
            // Update chart
            chart.data.labels = binLabels;
            chart.data.datasets[0].data = histogram;
            chart.update();
            
            // Calculate statistics
            const overallMean = calculateMean(sampleMeans);
            const variance = sampleMeans.reduce((acc, val) => acc + Math.pow(val - overallMean, 2), 0) / sampleMeans.length;
            const stdError = Math.sqrt(variance);
            
            // Calculate skewness
            const skewness = sampleMeans.reduce((acc, val) => acc + Math.pow((val - overallMean) / stdError, 3), 0) / sampleMeans.length;
            
            // Update results
            document.getElementById('sample-mean').textContent = overallMean.toFixed(4);
            document.getElementById('standard-error').textContent = stdError.toFixed(4);
            document.getElementById('skewness').textContent = skewness.toFixed(4);
        }
        
        function resetSimulation() {
            chart.data.labels = [];
            chart.data.datasets[0].data = [];
            chart.update();
            
            document.getElementById('sample-mean').textContent = '-';
            document.getElementById('standard-error').textContent = '-';
            document.getElementById('skewness').textContent = '-';
        }
    </script>
</body>
</html>
