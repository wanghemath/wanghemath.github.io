<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hypothesis Testing Simulation</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-type-selector {
            text-align: center;
            margin-bottom: 30px;
        }
        .test-type-btn {
            background-color: #e9ecef;
            color: #333;
            border: 2px solid transparent;
            padding: 10px 20px;
            margin: 0 5px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .test-type-btn.active {
            background-color: #007bff;
            color: white;
            border-color: #0056b3;
        }
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        .control-group {
            display: flex;
            flex-direction: column;
        }
        label {
            font-weight: bold;
            margin-bottom: 5px;
            color: #555;
        }
        input[type="range"] {
            width: 100%;
            margin-bottom: 5px;
        }
        .value-display {
            text-align: center;
            color: #007bff;
            font-weight: bold;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        #chart {
            margin: 20px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .hypothesis-display {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .hypothesis-box {
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        .h0 { background-color: #e3f2fd; border: 2px solid #2196f3; }
        .h1 { background-color: #fce4ec; border: 2px solid #e91e63; }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .stat-box {
            padding: 15px;
            background-color: #e9ecef;
            border-radius: 5px;
            text-align: center;
        }
        .stat-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }
        .decision-box {
            margin-top: 20px;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
        }
        .reject { background-color: #f8d7da; color: #721c24; }
        .fail-reject { background-color: #d4edda; color: #155724; }
        .error-display {
            margin-top: 20px;
            padding: 20px;
            background-color: #fff3cd;
            border-radius: 8px;
            border: 1px solid #ffeeba;
        }
        .explanation {
            margin-top: 30px;
            padding: 20px;
            background-color: #e8f4f8;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Hypothesis Testing Simulation</h1>
        
        <div class="test-type-selector">
            <button class="test-type-btn active" onclick="setTestType('one-sample')">One-Sample Test</button>
            <button class="test-type-btn" onclick="setTestType('two-sample')">Two-Sample Test</button>
        </div>
        
        <div class="hypothesis-display">
            <div class="hypothesis-box h0">
                <h3>Null Hypothesis (H₀)</h3>
                <p id="h0Text">μ = 50</p>
            </div>
            <div class="hypothesis-box h1">
                <h3>Alternative Hypothesis (H₁)</h3>
                <p id="h1Text">μ ≠ 50</p>
            </div>
        </div>
        
        <div class="controls">
            <div class="control-group">
                <label for="sampleSize">Sample Size (n):</label>
                <input type="range" id="sampleSize" min="10" max="200" value="30" step="5">
                <div class="value-display" id="sampleSizeValue">30</div>
            </div>
            
            <div class="control-group">
                <label for="alpha">Significance Level (α):</label>
                <input type="range" id="alpha" min="0.01" max="0.10" value="0.05" step="0.01">
                <div class="value-display" id="alphaValue">0.05</div>
            </div>
            
            <div class="control-group">
                <label for="h0Mean">H₀ Mean (μ₀):</label>
                <input type="range" id="h0Mean" min="40" max="60" value="50" step="0.5">
                <div class="value-display" id="h0MeanValue">50</div>
            </div>
            
            <div class="control-group">
                <label for="trueMean">True Mean (μ):</label>
                <input type="range" id="trueMean" min="40" max="60" value="52" step="0.5">
                <div class="value-display" id="trueMeanValue">52</div>
            </div>
            
            <div class="control-group">
                <label for="popStd">Population Std Dev (σ):</label>
                <input type="range" id="popStd" min="1" max="20" value="10" step="0.5">
                <div class="value-display" id="popStdValue">10</div>
            </div>
            
            <div class="control-group" id="tailControl">
                <label for="testTail">Test Type:</label>
                <select id="testTail" style="padding: 5px; border-radius: 3px;">
                    <option value="two">Two-tailed</option>
                    <option value="left">Left-tailed</option>
                    <option value="right">Right-tailed</option>
                </select>
            </div>
        </div>
        
        <div style="text-align: center;">
            <button onclick="runSingleTest()">Run Single Test</button>
            <button onclick="runMultipleTests()">Run 1000 Tests</button>
        </div>
        
        <canvas id="chart" width="900" height="400"></canvas>
        
        <div class="stats">
            <div class="stat-box">
                <div class="stat-label">Sample Mean (x̄)</div>
                <div class="stat-value" id="sampleMean">-</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Test Statistic (z)</div>
                <div class="stat-value" id="testStat">-</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">P-value</div>
                <div class="stat-value" id="pValue">-</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Critical Value(s)</div>
                <div class="stat-value" id="criticalValue">-</div>
            </div>
        </div>
        
        <div id="decisionBox" class="decision-box" style="display: none;"></div>
        
        <div id="errorDisplay" class="error-display" style="display: none;">
            <h3>Error Rates (from 1000 tests)</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 10px;">
                <div>
                    <strong>Type I Error Rate:</strong> <span id="typeIError">-</span>
                    <br><small>(Rejecting H₀ when it's true)</small>
                </div>
                <div>
                    <strong>Type II Error Rate:</strong> <span id="typeIIError">-</span>
                    <br><small>(Failing to reject H₀ when it's false)</small>
                </div>
            </div>
            <div style="margin-top: 10px;">
                <strong>Statistical Power:</strong> <span id="power">-</span>
                <br><small>(Correctly rejecting H₀ when it's false)</small>
            </div>
        </div>
        
        <div class="explanation">
            <h3>Understanding Hypothesis Testing</h3>
            <p>Hypothesis testing is a statistical method for making decisions using data. We start with a null hypothesis (H₀) and test whether the evidence is strong enough to reject it in favor of an alternative hypothesis (H₁).</p>
            <p><strong>Key Concepts:</strong></p>
            <ul>
                <li><strong>P-value:</strong> The probability of observing data at least as extreme as what we got, assuming H₀ is true</li>
                <li><strong>Significance level (α):</strong> The threshold for rejecting H₀ (commonly 0.05)</li>
                <li><strong>Type I Error:</strong> Rejecting H₀ when it's actually true (false positive)</li>
                <li><strong>Type II Error:</strong> Failing to reject H₀ when it's actually false (false negative)</li>
                <li><strong>Power:</strong> The probability of correctly rejecting a false H₀ (1 - Type II error rate)</li>
            </ul>
            <p><strong>Decision Rule:</strong> If p-value < α, reject H₀; otherwise, fail to reject H₀</p>
        </div>
    </div>

    <script>
        let testType = 'one-sample';
        const canvas = document.getElementById('chart');
        const ctx = canvas.getContext('2d');
        
        // Update slider values
        document.querySelectorAll('input[type="range"]').forEach(slider => {
            slider.addEventListener('input', (e) => {
                const valueDisplay = document.getElementById(e.target.id + 'Value');
                valueDisplay.textContent = e.target.value;
                updateHypotheses();
            });
        });
        
        document.getElementById('testTail').addEventListener('change', updateHypotheses);
        
        function setTestType(type) {
            testType = type;
            document.querySelectorAll('.test-type-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update UI based on test type
            if (type === 'two-sample') {
                document.getElementById('h0Text').textContent = 'μ₁ = μ₂';
                document.getElementById('h1Text').textContent = 'μ₁ ≠ μ₂';
                // Add additional controls for two-sample test if needed
            } else {
                updateHypotheses();
            }
        }
        
        function updateHypotheses() {
            const h0Mean = document.getElementById('h0Mean').value;
            const testTail = document.getElementById('testTail').value;
            
            document.getElementById('h0Text').textContent = `μ = ${h0Mean}`;
            
            if (testTail === 'two') {
                document.getElementById('h1Text').textContent = `μ ≠ ${h0Mean}`;
            } else if (testTail === 'left') {
                document.getElementById('h1Text').textContent = `μ < ${h0Mean}`;
            } else {
                document.getElementById('h1Text').textContent = `μ > ${h0Mean}`;
            }
        }
        
        function normalRandom(mean, std) {
            let u = 0, v = 0;
            while (u === 0) u = Math.random();
            while (v === 0) v = Math.random();
            return mean + std * Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);
        }
        
        function generateSample(n, mean, std) {
            const sample = [];
            for (let i = 0; i < n; i++) {
                sample.push(normalRandom(mean, std));
            }
            return sample;
        }
        
        function calculateZScore(sampleMean, h0Mean, popStd, n) {
            return (sampleMean - h0Mean) / (popStd / Math.sqrt(n));
        }
        
        function normCDF(z) {
            const a1 = 0.254829592;
            const a2 = -0.284496736;
            const a3 = 1.421413741;
            const a4 = -1.453152027;
            const a5 = 1.061405429;
            const p = 0.3275911;
            
            const sign = z < 0 ? -1 : 1;
            z = Math.abs(z) / Math.sqrt(2.0);
            
            const t = 1.0 / (1.0 + p * z);
            const y = 1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * Math.exp(-z * z);
            
            return 0.5 * (1.0 + sign * y);
        }
        
        function calculatePValue(z, testTail) {
            if (testTail === 'two') {
                return 2 * (1 - normCDF(Math.abs(z)));
            } else if (testTail === 'left') {
                return normCDF(z);
            } else {
                return 1 - normCDF(z);
            }
        }
        
        function getCriticalValue(alpha, testTail) {
            const zValues = {
                0.01: { two: 2.576, one: 2.326 },
                0.02: { two: 2.326, one: 2.054 },
                0.03: { two: 2.170, one: 1.881 },
                0.04: { two: 2.054, one: 1.751 },
                0.05: { two: 1.960, one: 1.645 },
                0.06: { two: 1.881, one: 1.555 },
                0.07: { two: 1.812, one: 1.476 },
                0.08: { two: 1.751, one: 1.405 },
                0.09: { two: 1.695, one: 1.341 },
                0.10: { two: 1.645, one: 1.282 }
            };
            
            const criticalZ = testTail === 'two' ? zValues[alpha].two : zValues[alpha].one;
            
            if (testTail === 'two') {
                return `±${criticalZ.toFixed(3)}`;
            } else if (testTail === 'left') {
                return `-${criticalZ.toFixed(3)}`;
            } else {
                return `${criticalZ.toFixed(3)}`;
            }
        }
        
        function runSingleTest() {
            const n = parseInt(document.getElementById('sampleSize').value);
            const h0Mean = parseFloat(document.getElementById('h0Mean').value);
            const trueMean = parseFloat(document.getElementById('trueMean').value);
            const popStd = parseFloat(document.getElementById('popStd').value);
            const alpha = parseFloat(document.getElementById('alpha').value);
            const testTail = document.getElementById('testTail').value;
            
            const sample = generateSample(n, trueMean, popStd);
            const sampleMean = sample.reduce((a, b) => a + b, 0) / n;
            const z = calculateZScore(sampleMean, h0Mean, popStd, n);
            const pValue = calculatePValue(z, testTail);
            
            // Update display
            document.getElementById('sampleMean').textContent = sampleMean.toFixed(3);
            document.getElementById('testStat').textContent = z.toFixed(3);
            document.getElementById('pValue').textContent = pValue.toFixed(4);
            document.getElementById('criticalValue').textContent = getCriticalValue(alpha, testTail);
            
            // Decision
            const reject = pValue < alpha;
            const decisionBox = document.getElementById('decisionBox');
            decisionBox.style.display = 'block';
            decisionBox.className = reject ? 'decision-box reject' : 'decision-box fail-reject';
            decisionBox.textContent = reject ? 
                'Reject H₀ - Evidence suggests the null hypothesis is false' : 
                'Fail to reject H₀ - Insufficient evidence against the null hypothesis';
            
            // Draw distribution
            drawDistribution(z, alpha, testTail);
        }
        
        function runMultipleTests() {
            const n = parseInt(document.getElementById('sampleSize').value);
            const h0Mean = parseFloat(document.getElementById('h0Mean').value);
            const trueMean = parseFloat(document.getElementById('trueMean').value);
            const popStd = parseFloat(document.getElementById('popStd').value);
            const alpha = parseFloat(document.getElementById('alpha').value);
            const testTail = document.getElementById('testTail').value;
            
            let rejectCount = 0;
            let typeIErrors = 0;
            let typeIIErrors = 0;
            const h0IsTrue = Math.abs(trueMean - h0Mean) < 0.001;
            
            for (let i = 0; i < 1000; i++) {
                const sample = generateSample(n, trueMean, popStd);
                const sampleMean = sample.reduce((a, b) => a + b, 0) / n;
                const z = calculateZScore(sampleMean, h0Mean, popStd, n);
                const pValue = calculatePValue(z, testTail);
                
                if (pValue < alpha) {
                    rejectCount++;
                    if (h0IsTrue) typeIErrors++;
                } else {
                    if (!h0IsTrue) typeIIErrors++;
                }
            }
            
            const errorDisplay = document.getElementById('errorDisplay');
            errorDisplay.style.display = 'block';
            
            if (h0IsTrue) {
                document.getElementById('typeIError').textContent = (typeIErrors / 10).toFixed(1) + '%';
                document.getElementById('typeIIError').textContent = 'N/A (H₀ is true)';
                document.getElementById('power').textContent = 'N/A (H₀ is true)';
            } else {
                document.getElementById('typeIError').textContent = 'N/A (H₀ is false)';
                document.getElementById('typeIIError').textContent = (typeIIErrors / 10).toFixed(1) + '%';
                document.getElementById('power').textContent = ((1000 - typeIIErrors) / 10).toFixed(1) + '%';
            }
        }
        
        function drawDistribution(zScore, alpha, testTail) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const padding = 40;
            const width = canvas.width - 2 * padding;
            const height = canvas.height - 2 * padding;
            
            // Draw normal distribution
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            for (let x = -4; x <= 4; x += 0.01) {
                const y = Math.exp(-0.5 * x * x) / Math.sqrt(2 * Math.PI);
                const px = padding + (x + 4) * width / 8;
                const py = canvas.height - padding - y * height * 2.5;
                
                if (x === -4) {
                    ctx.moveTo(px, py);
                } else {
                    ctx.lineTo(px, py);
                }
            }
            ctx.stroke();
            
            // Draw critical regions
            ctx.fillStyle = 'rgba(220, 53, 69, 0.3)';
            const criticalZ = parseFloat(getCriticalValue(alpha, testTail).replace('±', ''));
            
            if (testTail === 'two') {
                // Left tail
                ctx.beginPath();
                ctx.moveTo(padding, canvas.height - padding);
                for (let x = -4; x <= -criticalZ; x += 0.01) {
                    const y = Math.exp(-0.5 * x * x) / Math.sqrt(2 * Math.PI);
                    const px = padding + (x + 4) * width / 8;
                    const py = canvas.height - padding - y * height * 2.5;
                    ctx.lineTo(px, py);
                }
                ctx.lineTo(padding + (-criticalZ + 4) * width / 8, canvas.height - padding);
                ctx.fill();
                
                // Right tail
                ctx.beginPath();
                ctx.moveTo(padding + (criticalZ + 4) * width / 8, canvas.height - padding);
                for (let x = criticalZ; x <= 4; x += 0.01) {
                    const y = Math.exp(-0.5 * x * x) / Math.sqrt(2 * Math.PI);
                    const px = padding + (x + 4) * width / 8;
                    const py = canvas.height - padding - y * height * 2.5;
                    ctx.lineTo(px, py);
                }
                ctx.lineTo(canvas.width - padding, canvas.height - padding);
                ctx.fill();
            } else if (testTail === 'left') {
                ctx.beginPath();
                ctx.moveTo(padding, canvas.height - padding);
                for (let x = -4; x <= -criticalZ; x += 0.01) {
                    const y = Math.exp(-0.5 * x * x) / Math.sqrt(2 * Math.PI);
                    const px = padding + (x + 4) * width / 8;
                    const py = canvas.height - padding - y * height * 2.5;
                    ctx.lineTo(px, py);
                }
                ctx.lineTo(padding + (-criticalZ + 4) * width / 8, canvas.height - padding);
                ctx.fill();
            } else {
                ctx.beginPath();
                ctx.moveTo(padding + (criticalZ + 4) * width / 8, canvas.height - padding);
                for (let x = criticalZ; x <= 4; x += 0.01) {
                    const y = Math.exp(-0.5 * x * x) / Math.sqrt(2 * Math.PI);
                    const px = padding + (x + 4) * width / 8;
                    const py = canvas.height - padding - y * height * 2.5;
                    ctx.lineTo(px, py);
                }
                ctx.lineTo(canvas.width - padding, canvas.height - padding);
                ctx.fill();
            }
            
            // Draw test statistic
            const zX = padding + (zScore + 4) * width / 8;
            ctx.strokeStyle = '#007bff';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(zX, padding);
            ctx.lineTo(zX, canvas.height - padding);
            ctx.stroke();
            
            // Labels
            ctx.fillStyle = '#333';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            
            // X-axis labels
            for (let z = -3; z <= 3; z++) {
                const x = padding + (z + 4) * width / 8;
                ctx.fillText(z, x, canvas.height - padding + 20);
            }
            
            // Test statistic label
            ctx.fillStyle = '#007bff';
            ctx.font = 'bold 14px Arial';
            ctx.fillText(`z = ${zScore.toFixed(2)}`, zX, padding - 10);
            
            // Critical value labels
            ctx.fillStyle = '#dc3545';
            if (testTail === 'two') {
                const leftX = padding + (-criticalZ + 4) * width / 8;
                const rightX = padding + (criticalZ + 4) * width / 8;
                ctx.fillText(`-${criticalZ.toFixed(2)}`, leftX, canvas.height - padding - 10);
                ctx.fillText(`${criticalZ.toFixed(2)}`, rightX, canvas.height - padding - 10);
            } else if (testTail === 'left') {
                const leftX = padding + (-criticalZ + 4) * width / 8;
                ctx.fillText(`-${criticalZ.toFixed(2)}`, leftX, canvas.height - padding - 10);
            } else {
                const rightX = padding + (criticalZ + 4) * width / 8;
                ctx.fillText(`${criticalZ.toFixed(2)}`, rightX, canvas.height - padding - 10);
            }
        }
        
        // Initialize
        updateHypotheses();
        runSingleTest();
    </script>
</body>
</html>