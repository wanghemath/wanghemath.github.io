<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bayesian Coin Flip - Interactive Simulation</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        header h1 {
            font-size: 2.5em;
            font-weight: 300;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .back-link {
            text-align: center;
            margin: 20px 0;
        }
        
        .back-link a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        .back-link a:hover {
            text-decoration: underline;
        }
        
        .simulation-container {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            margin: 20px 0;
        }
        
        .description {
            margin-bottom: 30px;
            padding: 20px;
            background: #f7fafc;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        
        .coin-display {
            text-align: center;
            margin: 30px 0;
        }
        
        .coin {
            width: 150px;
            height: 150px;
            margin: 0 auto;
            border-radius: 50%;
            background: linear-gradient(135deg, #ffd700 0%, #ffed4b 100%);
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            font-weight: bold;
            color: #5a4a00;
            transition: transform 0.6s;
            cursor: pointer;
        }
        
        .coin.flipping {
            animation: flip 0.6s ease-in-out;
        }
        
        @keyframes flip {
            0% { transform: rotateY(0); }
            50% { transform: rotateY(180deg); }
            100% { transform: rotateY(360deg); }
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .control-group {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
        }
        
        .control-group label {
            display: block;
            color: #4a5568;
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .hypothesis-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .hypothesis-btn {
            flex: 1;
            padding: 8px 16px;
            border: 2px solid #e2e8f0;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }
        
        .hypothesis-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .btn-heads {
            background: #48bb78;
            color: white;
        }
        
        .btn-heads:hover {
            background: #38a169;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(72, 187, 120, 0.3);
        }
        
        .btn-tails {
            background: #f56565;
            color: white;
        }
        
        .btn-tails:hover {
            background: #e53e3e;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245, 101, 101, 0.3);
        }
        
        .btn-secondary {
            background: #e2e8f0;
            color: #2d3748;
        }
        
        .btn-secondary:hover {
            background: #cbd5e0;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin: 30px 0;
        }
        
        .results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .result-card {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .result-card h3 {
            color: #4a5568;
            font-size: 0.9em;
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .result-card .value {
            color: #667eea;
            font-size: 2em;
            font-weight: 600;
        }
        
        .flip-history {
            margin-top: 20px;
            padding: 20px;
            background: #f7fafc;
            border-radius: 10px;
            max-height: 100px;
            overflow-y: auto;
        }
        
        .flip-history h3 {
            color: #4a5568;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .flip-item {
            display: inline-block;
            margin: 2px;
            padding: 4px 8px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: 500;
        }
        
        .flip-item.heads {
            background: #c6f6d5;
            color: #276749;
        }
        
        .flip-item.tails {
            background: #fed7d7;
            color: #9b2c2c;
        }
        
        .theory-section {
            margin-top: 40px;
            padding: 30px;
            background: #edf2f7;
            border-radius: 10px;
        }
        
        .theory-section h2 {
            color: #2d3748;
            margin-bottom: 15px;
        }
        
        .theory-section p {
            color: #4a5568;
            line-height: 1.8;
            margin-bottom: 15px;
        }
        
        footer {
            text-align: center;
            padding: 40px 0;
            color: #718096;
        }
    </style>
</head>
<body>
    <header>
        <h1>Bayesian Coin Flip</h1>
        <p>Update beliefs with evidence</p>
    </header>
    
    <div class="container">
        <div class="back-link">
            <a href="../simulations.html">← Back to Simulations</a>
        </div>
        
        <div class="simulation-container">
            <div class="description">
                <p>This simulation demonstrates Bayesian inference in action. Start with a prior belief about whether a coin is fair or biased, then update your belief as you observe coin flips. Watch how the posterior probability changes with each new piece of evidence!</p>
            </div>
            
            <div class="coin-display">
                <div class="coin" id="coin">?</div>
            </div>
            
            <div class="controls">
                <div class="control-group">
                    <label>Prior Belief (Fair Coin Probability)</label>
                    <div class="hypothesis-buttons">
                        <button class="hypothesis-btn active" onclick="setPrior(0.5)">50%</button>
                        <button class="hypothesis-btn" onclick="setPrior(0.7)">70%</button>
                        <button class="hypothesis-btn" onclick="setPrior(0.3)">30%</button>
                        <button class="hypothesis-btn" onclick="setPrior(0.9)">90%</button>
                    </div>
                </div>
                <div class="control-group">
                    <label>True Coin Bias (for simulation)</label>
                    <div class="hypothesis-buttons">
                        <button class="hypothesis-btn active" onclick="setBias(0.5)">Fair (50%)</button>
                        <button class="hypothesis-btn" onclick="setBias(0.7)">Biased H (70%)</button>
                        <button class="hypothesis-btn" onclick="setBias(0.3)">Biased T (30%)</button>
                    </div>
                </div>
            </div>
            
            <div class="buttons">
                <button class="btn btn-heads" onclick="flipCoin('heads')">Flip Heads</button>
                <button class="btn btn-tails" onclick="flipCoin('tails')">Flip Tails</button>
                <button class="btn btn-secondary" onclick="autoFlip()">Auto Flip (10x)</button>
                <button class="btn btn-secondary" onclick="resetSimulation()">Reset</button>
            </div>
            
            <div class="chart-container">
                <canvas id="beliefChart"></canvas>
            </div>
            
            <div class="results">
                <div class="result-card">
                    <h3>P(Fair | Data)</h3>
                    <div class="value" id="posterior-fair">50.0%</div>
                </div>
                <div class="result-card">
                    <h3>P(Biased | Data)</h3>
                    <div class="value" id="posterior-biased">50.0%</div>
                </div>
                <div class="result-card">
                    <h3>Heads Count</h3>
                    <div class="value" id="heads-count">0</div>
                </div>
                <div class="result-card">
                    <h3>Tails Count</h3>
                    <div class="value" id="tails-count">0</div>
                </div>
            </div>
            
            <div class="flip-history">
                <h3>Flip History</h3>
                <div id="history-content">No flips yet</div>
            </div>
            
            <div class="theory-section">
                <h2>Understanding Bayesian Inference</h2>
                <p>Bayesian inference is a method of statistical inference that updates the probability of a hypothesis as more evidence becomes available. It combines:</p>
                <p><strong>Prior:</strong> Your initial belief before seeing any data (e.g., "I think there's a 50% chance this coin is fair")</p>
                <p><strong>Likelihood:</strong> The probability of observing the data given each hypothesis (e.g., "If the coin is fair, the probability of heads is 0.5")</p>
                <p><strong>Posterior:</strong> Your updated belief after seeing the data, calculated using Bayes' theorem:</p>
                <p style="text-align: center; font-family: monospace; background: white; padding: 15px; border-radius: 8px;">
                    P(Hypothesis | Data) = P(Data | Hypothesis) × P(Hypothesis) / P(Data)
                </p>
            </div>
        </div>
    </div>
    
    <footer>
        <p>&copy; 2024 Your Name. Educational Simulations.</p>
    </footer>
    
    <script>
        let headsCount = 0;
        let tailsCount = 0;
        let prior = 0.5;
        let trueBias = 0.5;
        let flipHistory = [];
        let beliefHistory = [0.5];
        let chart;
        
        // Initialize chart
        const ctx = document.getElementById('beliefChart').getContext('2d');
        chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Start'],
                datasets: [{
                    label: 'P(Fair Coin | Data)',
                    data: [0.5],
                    borderColor: 'rgba(102, 126, 234, 1)',
                    backgroundColor: 'rgba(102, 126, 234, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 1,
                        title: {
                            display: true,
                            text: 'Probability'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Number of Flips'
                        }
                    }
                },
                plugins: {
                    title: {
                        display: true,
                        text: 'Belief Evolution'
                    }
                }
            }
        });
        
        function setPrior(value) {
            prior = value;
            document.querySelectorAll('.control-group:first-child .hypothesis-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            resetSimulation();
        }
        
        function setBias(value) {
            trueBias = value;
            document.querySelectorAll('.control-group:last-child .hypothesis-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }
        
        function calculatePosterior() {
            const totalFlips = headsCount + tailsCount;
            if (totalFlips === 0) return prior;
            
            // Likelihood of observing the data if coin is fair
            const likelihoodFair = Math.pow(0.5, totalFlips);
            
            // Likelihood of observing the data if coin is biased (assuming 70% heads bias)
            const biasedProb = 0.7;
            const likelihoodBiased = Math.pow(biasedProb, headsCount) * Math.pow(1 - biasedProb, tailsCount);
            
            // Calculate posterior using Bayes' theorem
            const evidence = likelihoodFair * prior + likelihoodBiased * (1 - prior);
            const posteriorFair = (likelihoodFair * prior) / evidence;
            
            return posteriorFair;
        }
        
        function updateDisplay() {
            const posterior = calculatePosterior();
            beliefHistory.push(posterior);
            
            document.getElementById('posterior-fair').textContent = (posterior * 100).toFixed(1) + '%';
            document.getElementById('posterior-biased').textContent = ((1 - posterior) * 100).toFixed(1) + '%';
            document.getElementById('heads-count').textContent = headsCount;
            document.getElementById('tails-count').textContent = tailsCount;
            
            // Update chart
            chart.data.labels = beliefHistory.map((_, i) => i === 0 ? 'Start' : i);
            chart.data.datasets[0].data = beliefHistory;
            chart.update();
            
            // Update history
            if (flipHistory.length > 0) {
                const historyHtml = flipHistory.map(flip => 
                    `<span class="flip-item ${flip}">${flip === 'heads' ? 'H' : 'T'}</span>`
                ).join('');
                document.getElementById('history-content').innerHTML = historyHtml;
            }
        }
        
        function animateCoin(result) {
            const coin = document.getElementById('coin');
            coin.classList.add('flipping');
            
            setTimeout(() => {
                coin.textContent = result === 'heads' ? 'H' : 'T';
                coin.style.background = result === 'heads' 
                    ? 'linear-gradient(135deg, #48bb78 0%, #68d391 100%)'
                    : 'linear-gradient(135deg, #f56565 0%, #fc8181 100%)';
                coin.classList.remove('flipping');
            }, 300);
        }
        
        function flipCoin(forcedResult = null) {
            let result;
            if (forcedResult) {
                result = forcedResult;
            } else {
                result = Math.random() < trueBias ? 'heads' : 'tails';
            }
            
            if (result === 'heads') {
                headsCount++;
            } else {
                tailsCount++;
            }
            
            flipHistory.push(result);
            animateCoin(result);
            updateDisplay();
        }
        
        function autoFlip() {
            let flips = 0;
            const interval = setInterval(() => {
                flipCoin();
                flips++;
                if (flips >= 10) {
                    clearInterval(interval);
                }
            }, 500);
        }
        
        function resetSimulation() {
            headsCount = 0;
            tailsCount = 0;
            flipHistory = [];
            beliefHistory = [prior];
            
            document.getElementById('coin').textContent = '?';
            document.getElementById('coin').style.background = 'linear-gradient(135deg, #ffd700 0%, #ffed4b 100%)';
            document.getElementById('history-content').textContent = 'No flips yet';
            
            updateDisplay();
        }
        
        // Initialize display
        updateDisplay();
    </script>
</body>
</html>